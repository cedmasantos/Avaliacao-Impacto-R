---
title: " Notebook dos exercÃ­cios da Aula 2 - MQO, MÃ­nimos Quadrados OrdinÃ¡rios do curso de avaliaÃ§Ã£o de Impacto em R - FundaÃ§Ã£o Itau" 

output: html_notebook
---

Curso AvanÃ§ado de AvaliaÃ§Ã£o de PolÃ­ticas PÃºblicas e Projetos Sociais - FundaÃ§Ã£o ItaÃº

Aula 02 - MQO, MÃ­nimos Quadrados OrdinÃ¡rios.

Desenvolvido por: Cedma Santos

ExercÃ­cio 01: Baseado em: Wooldridge, J. M. IntroduÃ§Ã£o Ã  Econometria - Uma Abordagem Moderna. Exemplo 4.9

Considere o seguinte modelo para explicar o peso de recÃ©m-nascidos: ğ‘ğ‘’ğ‘ ğ‘œ_ğ‘›ğ‘ğ‘ ğ‘ğ‘–ğ‘šğ‘’ğ‘›ğ‘¡ğ‘œ = ğ›½0 + ğ›½1ğ‘ğ‘–ğ‘”ğ‘ğ‘Ÿğ‘Ÿğ‘œğ‘  + ğ›½2ğ‘œğ‘Ÿğ‘‘ğ‘’ğ‘š_ğ‘›ğ‘ğ‘ ğ‘ğ‘–ğ‘šğ‘’ğ‘›ğ‘¡ğ‘œ + ğ›½3ğ‘Ÿğ‘’ğ‘›ğ‘‘ğ‘_ğ‘“ğ‘ğ‘šğ‘–ğ‘™ğ‘–ğ‘ğ‘Ÿ + ğ›½4ğ‘’ğ‘‘ğ‘¢ğ‘ğ‘Ã§Ã£ğ‘œ_ğ‘šÃ£ğ‘’ + ğ›½5ğ‘’ğ‘‘ğ‘¢ğ‘ğ‘Ã§Ã£ğ‘œ_ğ‘ğ‘ğ‘– + ğ‘¢

A base BWGHT.dta Ã© utilizada para estudar determinantes do peso ao nascer (birth weight). Fonte: Introductory Econometrics: A Modern Approach do Jeffrey Wooldridge

DicionÃ¡rio de dados:

bwght: peso do bebÃª ao nascer (em onÃ§as).

cigs: nÃºmero mÃ©dio de cigarros fumados por dia durante a gravidez.

faminc: renda familiar em milhares de dÃ³lares.

otheduc: anos de escolaridade da mÃ£e.

fatheduc: anos de escolaridade do pai.

parity: nÃºmero de filhos anteriores da mÃ£e.

male: indicador se o bebÃª Ã© do sexo masculino (1 = sim, 0 = nÃ£o).

```{r}
setwd("C:/Users/cedma/Downloads/CursoR-Itau/Aula 2 - Causalidade e MQO") #definindo diretÃ³rio de tabalho

library(haven) #pacote para abrir base de dados no formato .dta

data1 <- read_dta("BWGHT.dta")
```

### a) Estime modelo e sumarize os resultados em tabela.

```{r}
mqo_1 <- lm(bwght ~ cigs + parity + motheduc + fatheduc, data = data)

# Visualizando os resultados: summary

summary(mqo_1)
```

```{r}

# stargazer: pacote que permite a visualizaÃ§Ã£o da saÃ­da da regressÃ£o em uma tabela limpa e organizada.
#install.packages('stargazer')
library(stargazer)

#Visualizando os resultados pelo stargazer

stargazer(mqo_1,
          type="text",
          title = "RegressÃ£o linar de peso ao nascer",
          dep.var.labels = "peso ao nascer",
          stlyer = "aer",
          model.names=TRUE)
```

A equaÃ§Ã£o estimada pelo MQO Ã©:

bwght =113.736âˆ’0.606â‹…cigs+1.765â‹…parityâˆ’0.276â‹…motheduc+0.580â‹…fatheduc

Intercepto (113.736): Quando todas as variÃ¡veis explicativas sÃ£o zero, o peso previsto ao nascer seria 113.736 onÃ§as. Esse valor nÃ£o tem um significado direto, pois dificilmente ocorre na prÃ¡tica.

Cigs (-0.606): Cada cigarro adicional fumado por dia durante a gravidez reduz, em mÃ©dia, o peso ao nascer em 0.606 onÃ§as. O coeficiente Ã© estatisticamente significativo (p\<0.01), ou seja, hÃ¡ forte evidÃªncia de que o tabagismo da mÃ£e impacta negativamente o peso do bebÃª.

Parity (+1.765): Cada filho anterior da mÃ£e aumenta, em mÃ©dia, o peso ao nascer em 1.765 onÃ§as. O coeficiente Ã© significativo ao nÃ­vel de 1%, sugerindo que bebÃªs de mÃ£es com mais filhos anteriores tendem a nascer com um peso um pouco maior.

Motheduc (-0.276): Cada ano adicional de escolaridade da mÃ£e reduz, em mÃ©dia, o peso ao nascer em 0.276 onÃ§as, mas esse efeito nÃ£o Ã© estatisticamente significativo (p\>0.1). Ou seja, nÃ£o podemos concluir que a educaÃ§Ã£o da mÃ£e tem um impacto claro no peso do bebÃª com base nesses dados.

Fatheduc (+0.580): Cada ano adicional de escolaridade do pai aumenta, em mÃ©dia, o peso ao nascer em 0.580 onÃ§as. Esse efeito Ã© significativo ao nÃ­vel de 5%, sugerindo que a educaÃ§Ã£o paterna pode estar associada a um maior peso ao nascer.

### b) Verifique se apÃ³s controlarmos pela quantidade de cigarros consumidos por dia pela mÃ£e durante a gravidez, ordem de nascimento e renda familiar, a educaÃ§Ã£o da mÃ£e e do pai, conjuntamente, nÃ£o tÃªm efeito sobre o peso de nascimento.

Para testar se a educaÃ§Ã£o da mÃ£e e do pai nÃ£o tem efeito sobre o peso ao nascer conjuntamente, serÃ¡ necessÃ¡rio realizar um teste de hipÃ³tese conjunta. O teste F Ã© o mais apropriado para testar a significÃ¢ncia conjunta, que verifica se os coeficientes de duas ou mais variÃ¡eis sÃ£o simultaneamente iguais a zero.

HipÃ³teses do teste F:

-   HipÃ³tese nula (ğ»0 ): A educaÃ§Ã£o da mÃ£e e do pai nÃ£o afeta o peso ao nascer, ou seja:

ğ»0:ğ›½3 = ğ›½4 = 0

-   HipÃ³tese alternativa (ğ»1 ): Pelo menos um dos coeficientes (ğ›½3 ou ğ›½4) Ã© diferente de zero.

O teste F compara dois modelos:

-   Modelo completo (nÃ£o restrito): contÃ©m todas as variÃ¡veis, incluindo motheduc e fatheduc.
-   Modelo restrito: removemos motheduc e fatheduc, ou seja, forÃ§amos ğ›½3 = 0 e ğ›½4 = 0, deixando apenas cigs, parity e outras variÃ¡veis.

```{r}

# car: pacote para realizar o teste de significÃ¢ncia conjunta

#install.packages('car')
library (car)

#Testando conjuntamente as hipÃ³teses de que o coeficiente de educaÃ§Ã£o da mÃ£e e do pai sÃ£o iguais a zero:

linearHypothesis(mqo_1, c("motheduc=0", "fatheduc=0"))

```

O **p-valor (**0.090770.090770.09077) Ã© maior que 0.05, mas **menor que 0.10**. Isso significa que, ao nÃ­vel de **5%**, **nÃ£o rejeitamos** H0H_0H0â€‹, ou seja, **nÃ£o hÃ¡ evidÃªncia suficiente de que a escolaridade dos pais afeta o peso ao nascer**.

No entanto, ao nÃ­vel de **10%**, o resultado seria **marginalmente significativo**, o que indica uma possÃ­vel influÃªncia fraca.

Se estivermos usando um **nÃ­vel de significÃ¢ncia de 5%** (Î±=0.05\alpha = 0.05Î±=0.05), **nÃ£o hÃ¡ evidÃªncia estatisticamente significativa de que a escolaridade dos pais influencia o peso ao nascer**. Se estivermos usando um **nÃ­vel de 10%** (Î±=0.10\alpha = 0.10Î±=0.10), **podemos argumentar que hÃ¡ uma pequena evidÃªncia de efeito**. O impacto individual da **motheduc** jÃ¡ era nÃ£o significativo no modelo original (p\>0.1p \> 0.1p\>0.1), mas o efeito de **fatheduc** era significativo ao nÃ­vel de 5%. O teste conjunto sugere que, em conjunto, os dois coeficientes nÃ£o sÃ£o estatisticamente diferentes de zero.

### C) Reestime o modelo, ainda por MQO, mas agora considerando a variÃ¡vel dependente em logaritmo natural.

```{r}
mqo_log <- lm(lbwght ~ cigs + parity + lfaminc + motheduc + fatheduc, data = data)
 
# Sumarize os dois modelos em uma sÃ³ tabela e compare os coeficientes estimados por MQO.

stargazer(mqo_1, mqo_2,
          type="text",
          title = "RegressÃ£o linear de peso ao nascer",
          dep.var.labels = c("peso ao nascer", "log(peso ao nascer)"),
          stlyer="aer",
          model.names = TRUE)

```


- O tabagismo materno tem um impacto negativo no peso ao nascer em ambos os modelos, mas no log-linear esse efeito Ã© percentual.
- O nÃºmero de filhos anteriores da mÃ£e aumenta proporcionalmente o peso do bebÃª, o que pode refletir maior experiÃªncia materna.
- A renda familiar tem um efeito positivo no peso ao nascer, e esse efeito Ã© mais claro no modelo log-linear.
- A escolaridade dos pais nÃ£o tem um efeito estatisticamente relevante apÃ³s controlar por outras variÃ¡veis.